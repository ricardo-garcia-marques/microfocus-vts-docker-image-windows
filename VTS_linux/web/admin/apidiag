<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script src="../../js/jquery-3.5.1.min.js" type="text/javascript"></script>
    <style>
        label
        {
            width: 8em;
            display: inline-block;
        }

        #editpanel
        {
        	background-color: #eee;
        	padding: 10px;
        }
        body, form
        {
        	margin:0;
        	padding:0;
        }
        .row
        {
        	margin:5px 0;
        }
        .result-panel,
        .result-panel div
        {

        	padding:5px 5px;
        }
        .result-panel
        {
             	margin:5px 5px;
        	border:1px solid;
        }
         .result-panel label
        {
        	font-weight:bold;
        }
        .hint
        {
        	font-style:italic;
        }
        
    </style>
    <script>
        var apis = ["","get",
"add",
"clear",
"inc",
"retrieve",
"update",
"update_ifequals",
"createColumn",
"clearColumn",
"ensureIndex",
"dropIndex",
"getColumnSize",
"handshake"
];
        $(function () {
            $(apis).each(function () {
                $("#APIs").append($("<option>").val(this).text(this));
            });
            $("#submit").click(submit);
        });

        function empty(s) {
            return (s == null || s == undefined || (typeof (s) == "string" && s.length == 0));
        }
        function submit() {
            cmd = $("#APIs").val();
            if (empty(cmd)) cmd = $("#cmd").val();
            var data = { params: $("#params").val(), cmd: cmd };
            $.ajax({
                url: '/data/diag/api',
                cache: false,
                data: data,
                type: 'get',
                dataType: 'text',
                complete: function (ret, status) {
                    $('#status').text(status);
                },
                success: function (ret) {
                    window.status = new Date();
					var data = null;
					try {
						data = eval('(' + ret + ')');
					}
					catch(ex) {
						$('#result').text(ret);
					}
					if (data) {
						$('#request').text(data.request);
						if (data.err && data.err.length > 0)
							$('#result').text('Error: ' + data.err);
						else
							$('#result').text(data.response);
					}
                },
                error: function (ret) {
                    window.status = new Date();
                    $('#result').text(ret.responseText);
                }
            });
        }
    </script>
</head>
<body>
    <form action="/data/diag/api" method="get">
    <div id="editpanel">
        <div class="row">
            <label for="cmd">
                Command:</label>
            <select id="APIs">
            </select>
            or
            <input type="text" id="cmd" value="getColumnSize" name="cmd" />
        </div>
        <div class="row">
            <label for="params">
                Other Parameters:</label><textarea id="params" name="params" cols="100" rows="10">
{"column":"a",
"index":1
}</textarea>
                <br /><span class="hint">Hint: The parameters can be
"data",
"status",
"version",
"error",
"code",
"columns",
"column",
"index",
"value",
"new",
"condition",
"option"
</span>
        </div>
        <div class="row"><button type="button" id="submit">Execute</button></div>
    </div>
    <div class="result-panel">
    	<div>
        <label>Status: </label><span id="status">
        </span>
        </div>
        <div>
        <label>Request:</label>
        </div>
        <pre id="request">
        </pre>

		<label>Result:</label>
		
        <pre id="result">
        </pre>

        </div>
    </div>
    </form>
</body>
</html>
